# Развертывание

Это руководство описывает развертывание системы Ordinaut в производственной среде.

## Настройка для производственной среды

### 1. Настройте вашу среду

!!! danger "Требуется критическое действие по безопасности"
    Перед развертыванием вы **ДОЛЖНЫ** настроить безопасный секрет JWT. Без него система небезопасна.

    1.  Перейдите в каталог `ops/`.
    2.  Скопируйте файл примера окружения: `cp .env.example .env`
    3.  Откройте файл `.env` и установите надежное, случайное значение для `JWT_SECRET_KEY` и `POSTGRES_PASSWORD`.

### 2. Разверните систему

Используйте предоставленный скрипт запуска для запуска системы с готовыми образами из GHCR.

```bash
# Из каталога ops/
./start.sh ghcr
```

## Масштабирование

Вы можете масштабировать количество сервисов `worker` и `api` для обработки больших нагрузок с помощью флага `--scale`.

```bash
# Масштабировать до 5 экземпляров воркеров
docker compose -f docker-compose.ghcr.yml up -d --scale worker=5
```

## Производственные операции

- **Резервное копирование базы данных:** Реализуйте стандартную стратегию резервного копирования для PostgreSQL (например, `pg_dump`).
- **Мониторинг:** Разверните стек мониторинга с помощью файла `docker-compose.observability.yml`.
- **Обновления:** для стабильности закрепите версии образов в `docker-compose.ghcr.yml` вместо использования `latest`.
