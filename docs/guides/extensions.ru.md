# –°–∏—Å—Ç–µ–º–∞ –†–∞—Å—à–∏—Ä–µ–Ω–∏–π

–°–∏—Å—Ç–µ–º–∞ –†–∞—Å—à–∏—Ä–µ–Ω–∏–π Ordinaut –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—â–Ω—É—é –∏ –≥–∏–±–∫—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∑–∞–¥–∞—á. –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.

## –û–±–∑–æ—Ä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π —Å–ª–µ–¥—É–µ—Ç **–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –ø–ª–∞–≥–∏–Ω–æ–≤** —Å **–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π**:

```mermaid
graph TB
    Core[Ordinaut Core] --> Loader[–ó–∞–≥—Ä—É–∑—á–∏–∫ –†–∞—Å—à–∏—Ä–µ–Ω–∏–π]
    Loader --> |–û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç| Built[–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –†–∞—Å—à–∏—Ä–µ–Ω–∏—è]
    Loader --> |–û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç| External[–í–Ω–µ—à–Ω–∏–µ –†–∞—Å—à–∏—Ä–µ–Ω–∏—è]
    Loader --> |–£–ø—Ä–∞–≤–ª—è–µ—Ç| Lifecycle[–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π –¶–∏–∫–ª]
    
    Built --> Obs[observability]
    Built --> WebUI[webui]
    Built --> MCP[mcp_http]
    Built --> Events[events_demo]
    
    Lifecycle --> Setup[–§–∞–∑–∞ Setup]
    Lifecycle --> Runtime[–§–∞–∑–∞ Runtime]
    Lifecycle --> Shutdown[–§–∞–∑–∞ Shutdown]
    
    Setup --> |–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç| Capabilities[–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏]
    Capabilities --> Routes[HTTP –ú–∞—Ä—à—Ä—É—Ç—ã]
    Capabilities --> Tools[–†–µ–µ—Å—Ç—Ä –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤]
    Capabilities --> EventsPub[–ü—É–±–ª–∏–∫–∞—Ü–∏—è –°–æ–±—ã—Ç–∏–π]
    Capabilities --> EventsSub[–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –°–æ–±—ã—Ç–∏—è]
    Capabilities --> Background[–§–æ–Ω–æ–≤—ã–µ –ó–∞–¥–∞—á–∏]
    Capabilities --> Static[–°—Ç–∞—Ç–∏—á–Ω—ã–µ –§–∞–π–ª—ã]
```

## –ö–ª—é—á–µ–≤—ã–µ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### üîê **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ –û—Å–Ω–æ–≤–µ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π**
–†–∞—Å—à–∏—Ä–µ–Ω–∏—è –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏ –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ –æ–¥–æ–±—Ä–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:
- `ROUTES` - –°–æ–∑–¥–∞–Ω–∏–µ HTTP –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫
- `TOOLS` - –î–æ—Å—Ç—É–ø –∫ —Ä–µ–µ—Å—Ç—Ä—É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- `EVENTS_PUB` - –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π
- `EVENTS_SUB` - –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
- `BACKGROUND_TASKS` - –î–æ–ª–≥–æ—Ä–∞–±–æ—Ç–∞—é—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
- `STATIC` - –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### üöÄ **–õ–µ–Ω–∏–≤–∞—è –ó–∞–≥—Ä—É–∑–∫–∞**
–†–∞—Å—à–∏—Ä–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏, –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—è –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤.

### üì° **–°–∏—Å—Ç–µ–º–∞ –°–æ–±—ã—Ç–∏–π**
–°–∏—Å—Ç–µ–º–∞ pub/sub –Ω–∞ –æ—Å–Ω–æ–≤–µ Redis Streams –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º –æ–±—â–∞—Ç—å—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º.

### üîß **–†–µ–µ—Å—Ç—Ä –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤**
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º –∏–º–µ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –¥–µ–π—Å—Ç–≤–∏—è.

### üìä **–§–æ–Ω–æ–≤—ã–µ –ó–∞–¥–∞—á–∏**
–°–∏—Å—Ç–µ–º–∞ —Å—É–ø–µ—Ä–≤–∏–∑–æ—Ä–∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥–æ–ª–≥–æ—Ä–∞–±–æ—Ç–∞—é—â–∏–º–∏ —Ñ–æ–Ω–æ–≤—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π.

## –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –†–∞—Å—à–∏—Ä–µ–Ω–∏—è

### observability
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ Prometheus –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥  
**–ö–æ–Ω–µ—á–Ω–∞—è –¢–æ—á–∫–∞**: `/ext/observability/metrics`  
**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**: `ROUTES`

–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤–∫–ª—é—á–∞—è:
- –ú–µ—Ç—Ä–∏–∫–∏ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏

### webui  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏  
**–ö–æ–Ω–µ—á–Ω–∞—è –¢–æ—á–∫–∞**: `/ext/webui/`  
**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**: `ROUTES`, `STATIC`

–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è pipeline
- –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏

### mcp_http
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Model Context Protocol —á–µ—Ä–µ–∑ HTTP  
**–ö–æ–Ω–µ—á–Ω–∞—è –¢–æ—á–∫–∞**: `/ext/mcp_http/`  
**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**: `ROUTES`

–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç HTTP –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —Å MCP –¥–ª—è:
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ –≤—ã–∑–æ–≤–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏—è–º–∏
- –ü–æ—Ç–æ–∫–æ–≤—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞–º–∏

### events_demo
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —Å–æ–±—ã—Ç–∏–π Redis Streams  
**–ö–æ–Ω–µ—á–Ω–∞—è –¢–æ—á–∫–∞**: `/ext/events_demo/`  
**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**: `ROUTES`, `EVENTS_PUB`, `EVENTS_SUB`

–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- –ü—É–±–ª–∏–∫–∞—Ü–∏—é –∏ –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ —Å–æ–±—ã—Ç–∏—è
- –ú–µ–∂—Ä–∞—Å—à–∏—Ä–µ–Ω—á–µ—Å–∫–æ–µ –æ–±—â–µ–Ω–∏–µ
- –ü–æ—Ç–æ–∫–æ–≤—É—é –ø–µ—Ä–µ–¥–∞—á—É —Å–æ–±—ã—Ç–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## –°–æ–∑–¥–∞–Ω–∏–µ –†–∞—Å—à–∏—Ä–µ–Ω–∏–π

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –†–∞—Å—à–∏—Ä–µ–Ω–∏—è

–ö–∞–∂–¥–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –¥–≤–∞ —Ñ–∞–π–ª–∞:

**extension.json** - –ú–∞–Ω–∏—Ñ–µ—Å—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:
```json
{
  "id": "–º–æ–µ_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ",
  "name": "–ú–æ–µ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ", 
  "version": "1.0.0",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è",
  "module": "extension.py",
  "enabled": true,
  "eager": false,
  "grants": ["ROUTES", "TOOLS"]
}
```

**extension.py** - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:
```python
from typing import Any, Optional
from fastapi import APIRouter, FastAPI
from ordinaut.plugins.base import Extension, ExtensionInfo, Capability

class –ú–æ–µ–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ(Extension):
    def info(self) -> ExtensionInfo:
        return ExtensionInfo(
            id="–º–æ–µ_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ",
            name="–ú–æ–µ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ",
            version="1.0.0",
            description="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è Ordinaut"
        )

    def requested_capabilities(self) -> set[Capability]:
        return {Capability.ROUTES, Capability.TOOLS}

    def setup(
        self,
        *,
        app: FastAPI,
        mount_path: str,
        tool_registry: Any,
        grants: set[Capability],
        context: dict[str, Any] | None = None,
    ) -> Optional[APIRouter]:
        router = APIRouter()

        @router.get("/–ø—Ä–∏–≤–µ—Ç")
        def –ø—Ä–∏–≤–µ—Ç():
            return {"—Å–æ–æ–±—â–µ–Ω–∏–µ": "–ü—Ä–∏–≤–µ—Ç –æ—Ç –º–æ–µ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è!"}

        # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –µ—Å–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å TOOLS
        if Capability.TOOLS in grants:
            tool_registry.register_tool("–º–æ–π_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç", —Ñ—É–Ω–∫—Ü–∏—è_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞)

        return router

    async def on_startup(self, app: FastAPI) -> None:
        print("–ú–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")

    async def on_shutdown(self, app: FastAPI) -> None:
        print("–ú–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è...")

def get_extension():
    return –ú–æ–µ–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ()
```

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –†–∞—Å—à–∏—Ä–µ–Ω–∏–π

–†–∞—Å—à–∏—Ä–µ–Ω–∏—è –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:

1. **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –†–∞—Å—à–∏—Ä–µ–Ω–∏—è**: –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `ordinaut/extensions/`
2. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –û–∫—Ä—É–∂–µ–Ω–∏—è**: –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `ORDINAUT_EXT_PATHS`
3. **Python Entry Points**: –≥—Ä—É–ø–ø–∞ entry point `ordinaut.plugins`

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```
–º–æ–µ_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ/
‚îú‚îÄ‚îÄ extension.json          # –ú–∞–Ω–∏—Ñ–µ—Å—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
‚îú‚îÄ‚îÄ extension.py           # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
‚îú‚îÄ‚îÄ static/               # –°—Ç–∞—Ç–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã (–ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ STATIC)
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îî‚îÄ‚îÄ style.css
‚îî‚îÄ‚îÄ templates/            # –§–∞–π–ª—ã —à–∞–±–ª–æ–Ω–æ–≤
    ‚îî‚îÄ‚îÄ dashboard.html
```

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –†–∞—Å—à–∏—Ä–µ–Ω–∏–π

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å ROUTES

–ü–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å HTTP –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏:

```python
def setup(self, *, app: FastAPI, mount_path: str, **kwargs) -> APIRouter:
    router = APIRouter()
    
    @router.get("/—Å—Ç–∞—Ç—É—Å")
    def get_status():
        return {"—Å—Ç–∞—Ç—É—Å": "–∑–¥–æ—Ä–æ–≤—ã–π"}
    
    @router.post("/–¥–µ–π—Å—Ç–≤–∏–µ")
    async def –≤—ã–ø–æ–ª–Ω–∏—Ç—å_–¥–µ–π—Å—Ç–≤–∏–µ(request: –ó–∞–ø—Ä–æ—Å–î–µ–π—Å—Ç–≤–∏—è):
        —Ä–µ–∑—É–ª—å—Ç–∞—Ç = await –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–¥–µ–π—Å—Ç–≤–∏–µ(request)
        return {"—Ä–µ–∑—É–ª—å—Ç–∞—Ç": —Ä–µ–∑—É–ª—å—Ç–∞—Ç}
    
    return router
```

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å TOOLS

–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ä–µ–µ—Å—Ç—Ä—É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:

```python
def setup(self, *, tool_registry: Any, grants: set[Capability], **kwargs):
    if Capability.TOOLS in grants:
        # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
        def –º–æ–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç(–≤—Ö–æ–¥–Ω—ã–µ_–¥–∞–Ω–Ω—ã–µ: dict) -> dict:
            return {"–æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ": True, "–¥–∞–Ω–Ω—ã–µ": –≤—Ö–æ–¥–Ω—ã–µ_–¥–∞–Ω–Ω—ã–µ}
        
        tool_registry.register_tool(
            name="ext.–º–æ–µ_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ.–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç",
            func=–º–æ–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç,
            schema={
                "input": {"type": "object"},
                "output": {"type": "object"}
            }
        )
```

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ EVENTS_PUB/EVENTS_SUB

–í–∫–ª—é—á–∞—é—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏—é –∏ –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ —Å–æ–±—ã—Ç–∏—è:

```python
def setup(self, *, context: dict[str, Any], grants: set[Capability], **kwargs):
    if Capability.EVENTS_PUB in grants or Capability.EVENTS_SUB in grants:
        events = context.get("events")
        
        if Capability.EVENTS_PUB in grants:
            # –ü—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è
            await events.publish("–∑–∞–¥–∞—á–∞.–∑–∞–≤–µ—Ä—à–µ–Ω–∞", {
                "task_id": "123",
                "—Å—Ç–∞—Ç—É—Å": "—É—Å–ø–µ—Ö"
            })
        
        if Capability.EVENTS_SUB in grants:
            # –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è
            async def –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Å–æ–±—ã—Ç–∏–µ_–∑–∞–¥–∞—á–∏(–¥–∞–Ω–Ω—ã–µ_—Å–æ–±—ã—Ç–∏—è):
                print(f"–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ –∑–∞–¥–∞—á–∏: {–¥–∞–Ω–Ω—ã–µ_—Å–æ–±—ã—Ç–∏—è}")
            
            await events.subscribe("task.*", –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Å–æ–±—ã—Ç–∏–µ_–∑–∞–¥–∞—á–∏)
```

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å BACKGROUND_TASKS

–£–ø—Ä–∞–≤–ª—è–µ—Ç –¥–æ–ª–≥–æ—Ä–∞–±–æ—Ç–∞—é—â–∏–º–∏ —Ñ–æ–Ω–æ–≤—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏:

```python
def setup(self, *, context: dict[str, Any], grants: set[Capability], **kwargs):
    if Capability.BACKGROUND_TASKS in grants:
        background = context.get("background")
        
        async def —Ñ–æ–Ω–æ–≤—ã–π_—Ä–∞–±–æ—Ç–Ω–∏–∫():
            while True:
                await –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ñ–æ–Ω–æ–≤—É—é_—Ä–∞–±–æ—Ç—É()
                await asyncio.sleep(60)
        
        # –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–æ–Ω–æ–≤—É—é –∑–∞–¥–∞—á—É
        await background.start_task("–º–æ–π_—Ä–∞–±–æ—Ç–Ω–∏–∫", —Ñ–æ–Ω–æ–≤—ã–π_—Ä–∞–±–æ—Ç–Ω–∏–∫)
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –†–∞—Å—à–∏—Ä–µ–Ω–∏–π

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –û–∫—Ä—É–∂–µ–Ω–∏—è

- `ORDINAUT_EXT_PATHS` - –ü—É—Ç–∏ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–µ –¥–≤–æ–µ—Ç–æ—á–∏–µ–º
- `ORDINAUT_EXT_ENTRY_GRANTS` - JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–π –¥–ª—è entry point —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π  
- `ORDINAUT_EXT_ENTRY_EAGER` - JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- `ORDINAUT_REQUIRE_SCOPES` - –í–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±–ª–∞—Å—Ç–µ–π

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ –û—Å–Ω–æ–≤–µ –û–±–ª–∞—Å—Ç–µ–π

–†–∞—Å—à–∏—Ä–µ–Ω–∏—è –º–æ–≥—É—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –æ–±–ª–∞—Å—Ç–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞:

```bash
# –¢—Ä–µ–±—É–µ—Ç –æ–±–ª–∞—Å—Ç—å 'ext:–º–æ–µ_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ:routes'
curl -H "X-Scopes: ext:–º–æ–µ_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ:routes" \\
     http://localhost:8080/ext/–º–æ–µ_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ/–∑–∞—â–∏—â–µ–Ω–Ω—ã–π
```

## –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π –¶–∏–∫–ª –†–∞—Å—à–∏—Ä–µ–Ω–∏—è

### –§–∞–∑–∞ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
1. –°–∫–∞–Ω–∏—Ä—É–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `ordinaut/extensions/` –¥–ª—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `ORDINAUT_EXT_PATHS`
3. –ó–∞–≥—Ä—É–∂–∞–µ—Ç Python entry points –∏–∑ –≥—Ä—É–ø–ø—ã `ordinaut.plugins`
4. –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –ø—Ä–æ—Ç–∏–≤ JSON —Å—Ö–µ–º—ã

### –§–∞–∑–∞ –ó–∞–≥—Ä—É–∑–∫–∏  
1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–æ–¥—É–ª—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
2. –í—ã–∑—ã–≤–∞–µ—Ç —Ñ–∞–±—Ä–∏—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `get_extension()`
3. –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –º–∞–Ω–∏—Ñ–µ—Å—Ç—É
4. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –§–∞–∑–∞ –ù–∞—Å—Ç—Ä–æ–π–∫–∏
1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —Å–æ–±—ã—Ç–∏—è, —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏)
2. –í—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥ `setup()` —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
3. –ú–æ–Ω—Ç–∏—Ä—É–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –ø—Ä–µ—Ñ–∏–∫—Å–æ–º
4. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞–ø—É—Å–∫–∞/–∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

### –§–∞–∑–∞ –í—ã–ø–æ–ª–Ω–µ–Ω–∏—è
1. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ –∫–æ–Ω–µ—á–Ω—ã–º —Ç–æ—á–∫–∞–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
2. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—ã–∑–æ–≤—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
3. –£–ø—Ä–∞–≤–ª—è–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π/–ø–æ–¥–ø–∏—Å–∫–æ–π –Ω–∞ —Å–æ–±—ã—Ç–∏—è
4. –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏

### –§–∞–∑–∞ –ó–∞–≤–µ—Ä—à–µ–Ω–∏—è
1. –í—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥ `on_shutdown()` —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
2. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
3. –û—á–∏—â–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã
4. –û—Ç–º–æ–Ω—Ç–∏—Ä—É–µ—Ç –º–∞—Ä—à—Ä—É—Ç—ã

## –õ—É—á—à–∏–µ –ü—Ä–∞–∫—Ç–∏–∫–∏ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –†–∞—Å—à–∏—Ä–µ–Ω–∏–π

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –∏—Å–ø–æ–ª—å–∑—É—è –º–æ–¥–µ–ª–∏ Pydantic –∏–ª–∏ JSON Schema
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±–ª–∞—Å—Ç–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π** —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ
- **–°–∞–Ω–∏—Ç–∏–∑–∏—Ä—É–π—Ç–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∏–Ω—ä–µ–∫—Ü–∏–æ–Ω–Ω—ã—Ö –∞—Ç–∞–∫
- **–ó–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ —Å–æ–±—ã—Ç–∏—è —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é** –¥–ª—è –∞—É–¥–∏—Ç–æ—Ä—Å–∫–∏—Ö —Å–ª–µ–¥–æ–≤

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–†–µ–∞–ª–∏–∑—É–π—Ç–µ async –º–µ—Ç–æ–¥—ã** –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–µ–Ω–∏–≤—É—é –∑–∞–≥—Ä—É–∑–∫—É** –¥–ª—è –¥–æ—Ä–æ–≥–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
- **–ö–µ—à–∏—Ä—É–π—Ç–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ**
- **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤** –∏ —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –ª–∏–º–∏—Ç—ã

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏ –≥—Ä–∞—Ü–∏–æ–∑–Ω–æ** —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥–∞–º–∏
- **–†–µ–∞–ª–∏–∑—É–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è** –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤  
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –æ—Ç–∫–∞—Ç** –¥–ª—è –ø–æ–≤—Ç–æ—Ä–æ–≤
- **–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö**

### –°–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ–º–æ—Å—Ç—å
- **–°–ª–µ–¥—É–π—Ç–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–º—É –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—é** –¥–ª—è —Ä–µ–ª–∏–∑–æ–≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
- **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ API** —Å OpenAPI —Å—Ö–µ–º–∞–º–∏
- **–ü–∏—à–∏—Ç–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã** –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –†–∞—Å—à–∏—Ä–µ–Ω–∏–π

### –ú–æ–¥—É–ª—å–Ω–æ–µ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
import pytest
from fastapi.testclient import TestClient
from –º–æ–µ_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ import get_extension

@pytest.fixture
def extension():
    return get_extension()

@pytest.fixture
def client(extension):
    app = FastAPI()
    router = extension.setup(
        app=app,
        mount_path="/test",
        tool_registry=MockToolRegistry(),
        grants={Capability.ROUTES}
    )
    app.include_router(router, prefix="/test")
    return TestClient(app)

def test_extension_endpoint(client):
    response = client.get("/test/–ø—Ä–∏–≤–µ—Ç")
    assert response.status_code == 200
    assert response.json() == {"—Å–æ–æ–±—â–µ–Ω–∏–µ": "–ü—Ä–∏–≤–µ—Ç –æ—Ç –º–æ–µ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è!"}
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
def test_extension_with_ordinaut():
    # –ó–∞–ø—É—Å–∫–∞–µ—Ç Ordinaut —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º
    with OrdianautTestServer(extensions=["–º–æ–µ_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ"]) as server:
        response = server.get("/ext/–º–æ–µ_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ/–ø—Ä–∏–≤–µ—Ç")
        assert response.status_code == 200
```

## –ü—Ä–∏–º–µ—Ä—ã –†–∞—Å—à–∏—Ä–µ–Ω–∏–π

### –ü—Ä–æ—Å—Ç–æ–µ HTTP –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ
```python
class –ü—Ä–æ—Å—Ç–æ–µHTTP–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ(Extension):
    def info(self) -> ExtensionInfo:
        return ExtensionInfo(
            id="–ø—Ä–æ—Å—Ç–æ–µ_http",
            name="–ü—Ä–æ—Å—Ç–æ–µ HTTP –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ",
            version="1.0.0"
        )

    def requested_capabilities(self) -> set[Capability]:
        return {Capability.ROUTES}

    def setup(self, **kwargs) -> APIRouter:
        router = APIRouter()
        
        @router.get("/–ø–∏–Ω–≥")
        def –ø–∏–Ω–≥():
            return {"–ø–æ–Ω–≥": True}
            
        return router
```

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –†–µ–µ—Å—Ç—Ä–∞ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
```python
class –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞(Extension):
    def requested_capabilities(self) -> set[Capability]:
        return {Capability.TOOLS}

    def setup(self, *, tool_registry, **kwargs):
        def –≤—ã—á–∏—Å–ª–∏—Ç—å_—Ö–µ—à(–¥–∞–Ω–Ω—ã–µ: str) -> str:
            import hashlib
            return hashlib.sha256(–¥–∞–Ω–Ω—ã–µ.encode()).hexdigest()
        
        tool_registry.register_tool("hash.sha256", –≤—ã—á–∏—Å–ª–∏—Ç—å_—Ö–µ—à)
```

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –û–±—Ä–∞–±–æ—Ç–∫–∏ –°–æ–±—ã—Ç–∏–π  
```python
class –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ–°–æ–±—ã—Ç–∏—è(Extension):
    def requested_capabilities(self) -> set[Capability]:
        return {Capability.EVENTS_SUB, Capability.EVENTS_PUB}

    def setup(self, *, context, **kwargs):
        events = context["events"]
        
        async def –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ_–∑–∞–¥–∞—á–∏(–¥–∞–Ω–Ω—ã–µ_—Å–æ–±—ã—Ç–∏—è):
            # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É
            —Ä–µ–∑—É–ª—å—Ç–∞—Ç = await –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ä–µ–∑—É–ª—å—Ç–∞—Ç_–∑–∞–¥–∞—á–∏(–¥–∞–Ω–Ω—ã–µ_—Å–æ–±—ã—Ç–∏—è)
            
            # –ü—É–±–ª–∏–∫—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            await events.publish("–∑–∞–¥–∞—á–∞.–æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞", —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
        
        # –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á
        events.subscribe("–∑–∞–¥–∞—á–∞.–∑–∞–≤–µ—Ä—à–µ–Ω–∞", –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ_–∑–∞–¥–∞—á–∏)
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ù–µ–ø–æ–ª–∞–¥–æ–∫

### –û–±—â–∏–µ –ü—Ä–æ–±–ª–µ–º—ã

**–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ JSON —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è `get_extension()` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤ –ø—É—Ç–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è

**–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –æ–±–ª–∞—Å—Ç–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

**–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–∞–¥–∞–µ—Ç**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –æ—à–∏–±–∫–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤ –∏–∑–æ–ª—è—Ü–∏–∏

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –û—Ç–ª–∞–¥–∫–∏

```bash
# –°–ø–∏—Å–æ–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
curl http://localhost:8080/ext/status

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
curl http://localhost:8080/ext/–º–æ–µ_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ/health

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
curl http://localhost:8080/ext/observability/metrics | grep extension
```

–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–¥–µ–∂–Ω—É—é –æ—Å–Ω–æ–≤—É –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π Ordinaut, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏.