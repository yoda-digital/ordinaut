# Мониторинг

Ordinaut разработан для производственных сред и предоставляет ключевые метрики для мониторинга и оповещения.

## Метрики Prometheus

Система предоставляет эндпоинт, совместимый с Prometheus, по адресу `/metrics`. Ключевые метрики включают:

- `orchestrator_tasks_total`: Счетчик созданных задач.
- `orchestrator_runs_total`: Счетчик запусков задач с метками по статусу (`успех`, `неудача`).
- `orchestrator_step_duration_seconds`: Гистограмма времени выполнения шагов конвейера.
- `orchestrator_due_work_queue_depth`: Датчик, показывающий количество ожидающих заданий.
- `orchestrator_scheduler_lag_seconds`: Датчик, измеряющий задержку между запланированным временем и фактическим выполнением.

## Панели мониторинга Grafana

Рекомендуется настроить панели мониторинга Grafana для визуализации этих метрик. Ключевые панели включают:

- **Состояние системы:** Обзор времени отклика API, частоты ошибок и состояния компонентов.
- **Анализ задач и запусков:** Отслеживание созданных и завершенных задач, показателей успеха/неудачи и наиболее часто сбоящих задач.
- **Производительность воркеров:** Мониторинг глубины очереди, задержки обработки и загруженности воркеров.

## Логирование

Все сервисы создают структурированные журналы (JSON) с идентификаторами корреляции (`task_id`, `run_id`), что позволяет легко фильтровать и анализировать их в централизованной платформе логирования, такой как Loki или стек ELK.
