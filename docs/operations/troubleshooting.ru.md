# Устранение неполадок

Это руководство предоставляет решения для распространенных проблем, с которыми вы можете столкнуться при работе с Ordinaut.

## Диагностический контрольный список

1.  **Проверьте состояние системы:** `curl http://localhost:8080/health | jq`
2.  **Проверьте статус контейнеров:** `docker compose ps`
3.  **Проверьте журналы сервисов:** `docker compose logs -f <service_name>`

## Распространенные проблемы

### Ошибки аутентификации (`401`/`403`)

- **Симптом:** Вы получаете ошибку `401 Unauthorized` или `403 Forbidden`.
- **Решение:**
    1.  **`401 Unauthorized`**: Убедитесь, что вы предоставляете действительный токен JWT в заголовке `Authorization: Bearer <token>`.
    2.  **`403 Forbidden`**: У аутентифицированного агента нет необходимых `scopes` для выполнения действия.
    3.  **Ознакомьтесь с предупреждениями о безопасности:** Проверьте руководство по [Аутентификации](../api/authentication.md) на наличие критических предупреждений.

### Задачи не выполняются

- **Симптом:** Вы создаете задачу, но она никогда не выполняется.
- **Решение:**
    1.  Проверьте очередь `due_work` в базе данных PostgreSQL.
    2.  Проверьте журналы `scheduler`.
    3.  Убедитесь, что статус задачи — `active`.

### Шаг конвейера завершается сбоем

- **Симптом:** Запуск задачи имеет статус `success: false`.
- **Решение:**
    1.  Получите детали запуска с помощью `GET /runs/{id}`.
    2.  Изучите поле `error`.
    3.  Проверьте журналы `worker`.

### Сервис не запускается

- **Симптом:** Контейнер (например, `api`) немедленно завершает работу или находится в цикле перезапуска.
- **Решение:**
    1.  **Проверьте отсутствие секретов:** для производственных развертываний убедитесь, что вы создали файл `.env` в каталоге `ops/` и установили безопасный `JWT_SECRET_KEY`.
    2.  **Проверьте работоспособность базы данных/Redis:** Убедитесь, что контейнеры `postgres` и `redis` работоспособны.
